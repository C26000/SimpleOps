<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="CSS/Estilos.css">
</head>

<body>

    <style>
        /* Temporalmente se copia textual desde Estilos.css para poder que funcione con htmlpreview.github.io. */

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: 800px;
            margin: auto;
        }

        img {
            display: block;
            margin: auto;
            margin-top: 80px;
            margin-bottom: 80px;
            max-width: 800px;
        }

        h1, h2 {
            margin-top: 80px;
            margin-bottom: 30px;
        }

        h3 {
            margin-top: 40px;
        }

        li {
            margin-bottom: 10px;
            margin-top: 10px;
        }

    </style>

    <h1>Habilitación de Facturación Electrónica DIAN con SimpleOps</h1>
    <p>
        Para que <b>SimpleOps</b> pueda generar tus facturas electrónicas válidas legalmente es necesario que habilites a tu
        empresa ante la DIAN cómo facturador electrónico usando <b>SimpleOps</b>, que compres y generes un certificado de firma digital con una entidad
        certificadora y que realices las pruebas de facturación electrónica con <b>SimpleOps</b> en el servidor de la DIAN.
    </p>

    <p>
        Esta guía fue escrita para empresas (personas jurídicas). Si necesitas el facturar electrónicamente como persona natural aún puedes seguir
        esta guía, pero ten en cuenta que tendrás que realizar algunos pasos de manera diferente.
    </p>

    <h2>Habilitación de Pruebas en la DIAN</h2>

    <p>
        Ingresa a <a href="https://www.dian.gov.co">www.dian.gov.co</a> y haz clic en <i>Temas de interés > Factura Electrónica > Habilitación</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/DianHabilitación.png" />

    <p>
        Selecciona <i>Empresa</i>.
        Si el representante legal de tu empresa es una persona natural colombiana deja la opción <i>Cédula de ciudadanía</i> seleccionada.
        Ingresa el número de la cédula del representante legal, el NIT de tu empresa sin número de verificación y has clic en <i>Entrar</i>.
        Si te aparece el error <i>Recaptcha inválido</i>, ingresa nuevamente desde <a href="https://www.dian.gov.co">www.dian.gov.co</a>
        y hazlo más rápidamente.
    </p>

    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/EntrarDianPortal.png" />

    <p>Obtendrás un mensaje así:</p>

    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/MensajeEnlaceAccesoDIAN.png" />

    <p>
        Revisa tu cuenta de email que registraste en la DIAN cuando actualizaste tu RUT, abre el mensaje que te debió haber llegado de la DIAN
        y haz clic en <i>Acceder</i>.
    </p>

    <p>
        Se abrirá el portal de habilitación.
        Haz clic en <i>Participantes > Facturador</i>. Revisa los datos de tu empresa, agrega el correo electrónico donde recibirás las facturas
        electrónicas de tus proveedores y haz clic en <i>Registrar</i>.
    </p>

    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/RegistroFacturadorElectrónico.png" />

    <p>
        Te preguntará que si estás seguro de proceder, dale clic en <i>Sí</i> e inicia otra vez sesión como se describió anteriormente.
        Haz clic en <i>Participantes > Facturador</i> y haz clic en <i>Configurar modos de operación</i>.
    </p>

    <p>
        Selecciona la opción <i>Software Propio</i>. En <i>Nombre del software</i> escribe SimpleOps######### donde ######### es el Nit de tu empresa.
        Por ejemplo, SimpleOps990823244. En <i>Pin del SW</i> escribe una contraseña propia de 5 números, guárdala en un lugar seguro con el nombre
        <i>PinAplicación</i>. Finalmente, haz clic en <i>Adicionar</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/AdiciónModoOperación.png" />

    <p>
        Se agregará una nueva fila a la tabla inferior.
        Haz clic en el ícono derecho en la columna <i>Acciones</i>. Ten cuidado de no hacer clic en la papelera que está a la izquierda de este.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/DetallesSetDePruebas.png" />

    <p>
        Te aparecerá una página donde debes copiar y guardar en un lugar seguro estos valores que necesitarás para configurar <b>SimpleOps</b>
        e iniciar las pruebas de facturación:

        <ul>
            <li><i>TestSetID</i>, guárdalo con el nombre <i>IdentificadorPruebas</i>.</li>
            <li><i>Número Resolución</i>, guárdalo con el nombre <i>NúmeroAutorizaciónFacturación</i>.</li>
            <li><i>Rango desde</i>, guárdalo con el nombre <i>PrimerNúmeroFacturaAutorizada</i>.</li>
            <li><i>Rango hasta</i>, guárdalo con el nombre <i>ÚltimoNúmeroFacturaAutorizada</i>.</li>
            <li><i>Fecha desde</i>, guárdala con el nombre <i>InicioAutorizaciónFacturación</i>.</li>
            <li><i>Fecha hasta</i>, guárdala con el nombre <i>FinAutorizaciónFacturación</i>.</li>
            <li><i>Identificación</i>, guárdala con el nombre <i>IdentificadorAplicación</i>.</li>
            <li><i>Clave técnica</i>, guárdala con el nombre <i>ClaveTécnicaAplicación</i>.</li>
            <li><i>Pin</i>, guárdalo con el nombre <i>PinAplicación</i>. Este valor ya lo deberías tener guardado del paso anterior.</li>
        </ul>

    </p>

    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/ParametrosFacturaciónElectrónica.png" />

    <p>
        Al copiar los valores asegúrate que los estas copiando completos, si la pantalla de tu computador es pequeña parte de algunos textos
        se pueden esconder. Si este es tu caso, selecciona con el mouse desde el inicio del texto, desplázalo hasta el
        final del cuadro de texto hasta que no aparezcan más letras nuevas y presiona Ctrl + C para copiar.
    </p>

    <p>
        Al finalizar estos pasos tu empresa quedará habilitada en la DIAN para iniciar las pruebas de facturación electrónica usando <b>SimpleOps</b>.
        Para realizar estas pruebas necesitarás un certificado de firma digital.
    </p>


    <h2>Obtención de Certificado de Firma Digital</h2>
    <p>
        Un certificado digital es un archivo con extensión PFX que necesitarás para enviar las facturas electrónicas a la DIAN.
        Existen varias entidades certificadoras en Colombia que te pueden vender este archivo anualmente.
        Las puedes consultar <a href="https://onac.org.co/directorio-de-acreditacion-buscador">aquí</a>,
        selecciona <i>Entidades Certificación Digital (ECD)</i>, <i>Entidad de Certificación Abierta</i> y haz clic en <i>Buscar</i>.
    </p>

    <p>
        Si actualmente facturas electrónicamente con otra aplicación o con el portal de la DIAN, no necesitarás realizar este procedimiento
        nuevamente para poder facturar con <b>SimpleOps</b>. El certificado de firma digital que ya tienes te servirá,
        asegúrate de tener tu archivo PFX y tu clave y puedes pasar al procedimiento de pruebas.
    </p>


    <p>
        Si aún no facturas electrónicamente y no tienes certificado de firma digital puedes seguir
        <a href="Certificado de Firma Digital Andes.html">esta guía</a> para
        adquirirlo con Andes SCD.
        <b>SimpleOps</b> no tiene ninguna relación con Andes SCD ni recibe comisión por realizar esta recomendación.
    </p>


    <h2>Configuración de SimpleOps y Pruebas de Habilitación</h2>

    <p>
        Una vez hayas habilitado a <b>SimpleOps</b> en el portal de la DIAN y hayas obtenido el certificado de firma digital podrás configurar
        <b>SimpleOps</b> con los datos de tu empresa y realizar las pruebas en el servidor de la DIAN, que una vez pasadas te permitirán empezar
        a facturar electrónicamente.
    </p>

    <h3>Instalación de SimpleOps</h3>
    <p>
        <b>SimpleOps</b> se encuentra en una etapa preliminar de desarrollo, por lo tanto aún no cuenta con instalador y la mejor
        manera de ejecutarlo es directamente desde el código fuente. Para ejecutar el código necesitarás
        <a href="https://visualstudio.microsoft.com/es/vs/community/">Visual Studio</a>. Si quieres ejecutar <b>SimpleOps</b> sin necesidad
        de instalar Visual Studio, me puedes escribir a vixark@outlook.com.
    </p>

    <p>
        Crea una carpeta en tu computador con el nombre <i>SimpleOps</i> y crea dentro de ella la carpeta <i>Código</i>
        y la carpeta <i>Firma Electrónica</i>. Para fines de esta guía la carpeta donde creaste la carpeta
        <i>SimpleOps</i> se llamará <i>[CarpetaProgramas]</i>, por ejemplo si la creaste en <i>D:\Programas\SimpleOps</i>,
        tu <i>[CarpetaProgramas]</i> será <i>D:\Programas</i>.
        Asegúrate de crear las carpetas exactamente cómo están escritas (incluyendo tildes) para que después no tengas
        contratiempos.
    </p>

    <p>
        Copia y pega (no lo cortes) tu archivo PFX con tu certificado de firma digital en <i>[CarpetaProgramas]\SimpleOps\Firma Electrónica</i> y renómbralo a
        <i>Certificado.pfx</i>. Crea un archivo de texto (extensión .txt) en <i>[CarpetaProgramas]\SimpleOps\Firma Electrónica</i>,
        nómbralo <i>Clave.txt</i>,
        ábrelo, escribe tu clave del certificado de firma digital sin agregar espacios ni nuevas líneas y guárdalo.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/ArchivosFirmaElectrónica.png" />

    <p>
        Abre Visual Studio y haz clic en <i>Tareas Iniciales > Clonar un repositorio</i>. En <i>Ubicación del repositorio</i>
        ingresa https://github.com/vixark/SimpleOps.git y en <i>Ruta de acceso</i> selecciona <i>[CarpetaProgramas]\SimpleOps\Código</i>
        y haz clic en
        <i>Clonar</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/ClonarRepositorio.png" />


    <p>
        Abre el <i>Explorador de Soluciones</i> y haz doble clic en <i>SimpleOps.sln</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/AbrirSimpleOpsSln.png" />

    <p>
        Con esto abrirás el código por primera vez. La próxima vez que vayas a abrir el código abre
        el archivo <i>[CarpetaProgramas]\SimpleOps\Código\SimpleOps.sln</i> y actualiza el código a la última versión en GitHub haciendo clic
        en la esquina inferior derecha
        en <i>master > "Pull"</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/ActualizarCambiosSimpleOpsSln.png" />

    <p>
        Si te sale el error <i>No se pueden incorporar los cambios...</i>, en <i>Cambios de GIT > Cambios</i>, haz <i>clic derecho > Deshacer Cambios</i>
        en los archivos que cambiaste (usualmente <i>OpcionesEquipo.cs</i> y <i>Global.cs</i>) e intenta
        actualizar el código nuevamente.
        Ten cuidado si has realizado
        cambios al código adicionales a los indicados en esta guía porque te podrían aparecer más archivos en conflicto y deberás analizar con
        más cuidado
        cómo proceder para evitar perder tus cambios.
    </p>

    <p>
        Busca (Ctrl + F) el texto <i>Public string RutaAplicación</i> para que encuentres el siguiente fragmento de código y reemplaza en los 4
        textos indicados <i>D:\Programas</i> por <i>[CarpetaProgramas]</i>.
        Esto deberás hacerlo nuevamente si te salió el error <i>No se pueden incorporar los cambios...</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/CambioRutasCódigo.png" />

    <p>
        Busca el texto <i>public static string RutaDesarrollo</i> para que encuentres el siguiente fragmento de código y reemplaza todo el texto
        entre comillas por <i>[CarpetaProgramas]\SimpleOps\Código\SimpleOps</i>. Esto deberás hacerlo nuevamente si te salió el error
        <i>No se pueden incorporar los cambios...</i>.
    </p>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/RutaDesarrolloSimpleOps.png" />


    <p>
        Ejecuta <b>SimpleOps</b> (F5), espera unos segundos y te aparecerá un mensaje que dice <i>Base de Datos SQLite Creada</i>, esto significa
        que realizaste correctamente los pasos anteriores y que se creo la base de datos y todos los archivos necesarios para ejecutar <b>SimpleOps</b>.
        Suspende la ejecución (Shift + F5).
    </p>

    <h3>Configuración de Datos de tu Empresa</h3>

    <p>
        Para hacerlo necesitarás agregar varios datos de tu empresa al archivo <i>Empresa.json</i>.
        Abre el archivo <i>[CarpetaProgramas]\SimpleOps\Opciones\Empresa.json</i> con Visual Studio
        (<i>clic derecho > Abrir con.. > Microsoft Visual Studio</i>).
        Para editarlo más fácil haz <i>clic derecho en el texto > Desminimizar</i>.
    </p>

    <p>
        Al agregar los valores usa dobles comillas ("") para los valores <b>[Texto]</b>, ninguna comilla para los <b>[Número]</b>, el formato
        "YYYY-MM-DDT00:00:00Z" (con dobles comillas) para <b>[Fecha]</b> y true o false (sin comillas) para <b>[Booleano]</b>.
    </p>

    <p>
        Si un texto tiene tildes o eñes debes procesarlo con esta
        <a href="https://www.freeformatter.com/json-escape.html#ad-output">utilidad</a>. Ingresa el texto en el cuadro, haz clic en <i>ESCAPE</i>,
        ,copia el texto del cuadro <i>Escaped string</i> y pégalo en el archivo. Por ejemplo, el texto <i>Corporación</i> se convierte en
        <i>Corporaci\u00F3n</i>, que es el texto que se debe usar.
    </p>

    <ul>
        <li>
            <b>MunicipioFacturaci\u00F3nID [Número]:</b>
            ID del municipio de la dirección de facturación. Encuentra los IDs de los municipios <a href="IDs Municipios.html">aquí</a>.
        </li>

        <li>
            <b>MunicipioUbicaci\u00F3nID [Número]:</b>
            Se usa si es necesario especificar un municipio diferente al de facturación para la ubicación de la empresa.
            Si se deja en <i>null</i>, se usa MunicipioFacturaciónID.
        </li>

        <li>
            <b>Raz\u00F3nSocial [Texto]:</b>
            Razón social como está registrada en el RUT.
        </li>

        <li>
            <b>Tel\u00E9fonoPrincipal [Texto]:</b>
            Línea telefónica principal. Puede ser celular o fijo.
        </li>

        <li>
            <b>EmailVentas [Texto]:</b>
            Email principal de ventas. Se escribirá en la representación gráfica de la factura electrónica.
        </li>

        <li>
            <b>SitioWeb [Texto]:</b>
            Sitio web. Si no tiene, puedes dejarlo en <i>null</i>.
        </li>

        <li>
            <b>Direcci\u00F3nFacturaci\u00F3n [Texto]:</b>
            Dirección de facturación registrada en el RUT.
        </li>

        <li>
            <b>Direcci\u00F3nUbicaci\u00F3n  [Texto]:</b>
            Se usa si es necesario especificar una dirección diferente a la de facturación para la ubicación de la empresa.
            Si se deja en <i>null</i>, se usa la dirección de facturación.
        </li>

        <li>
            <b>Nit [Texto]:</b>
            Nit sin dígito de verificación.
        </li>

        <li>
            <b>NombreComercial [Texto]:</b>
            Se usa para informarlo a la DIAN al hacer la factura electrónica y para usarlo en representación gráfica de la factura electrónica.
            Si se deja en <i>null</i>, se omite en la factura electrónica y en la representación gráfica se usa la razón social.
        </li>

        <li>
            <b>TipoContribuyente [Texto]:</b>
            Los tipos de contribuyente que le aplican separados por coma. Las opciones disponibles son:
            Ordinario (le aplica a las empresas que no se ha acogido a uno de los otros régimenes como simple o gran contribuyente), GranContribuyente
            Autorretenedor, RetenedorIVA, RégimenSimple, ResponsableIVA y NoResponsableIVA.
        </li>

        <li>
            <b>N\u00FAmeroAutorizaci\u00F3nFacturaci\u00F3n [Número]:</b>
            Número del código de la resolución otorgada para la numeración de facturación.
            El número que copiaste desde el portal de la DIAN con nombre <i>NúmeroAutorizaciónFacturación</i>.
        </li>

        <li>
            <b>InicioAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b>
            Fecha inicial de la autorización de la numeración de facturación.
            La fecha que copiaste desde el portal de la DIAN con nombre <i>InicioAutorizaciónFacturación</i>. Recuerda usar el formato
            "YYYY-MM-DDT00:00:00Z" para ingresar las fechas, por ejemplo "2019-01-19T00:00:00Z".
        </li>

        <li>
            <b>FinAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b>
            Fecha final de la autorización de la numeración de facturación.
            La fecha que copiaste desde el portal de la DIAN con nombre <i>FinAutorizaciónFacturación</i>.
        </li>

        <li>
            <b>PrefijoFacturas [Texto]:</b>
            Prefijo de la autorización de numeración de facturación dado por el SIE de numeración.
            Cómo primero vas a realizar las pruebas de facturación ingresa el prefijo de pruebas: "SETP".
        </li>

        <li>
            <b>PrimerN\u00FAmeroFacturaAutorizada [Número]:</b>
            Valor inicial del rango de numeración otorgado por la DIAN.
            El número que copiaste desde el portal de la DIAN con nombre <i>PrimerNúmeroFacturaAutorizada</i>.
        </li>

        <li>
            <b>\u00DAltimoN\u00FAmeroFacturaAutorizada [Número]:</b>
            Valor final del rango de numeración otorgado por la DIAN.
            El número que copiaste desde el portal de la DIAN con nombre <i>ÚltimoNúmeroFacturaAutorizada</i>.
        </li>

        <li>
            <b>IdentificadorPruebas [Texto]:</b>
            Texto provisto por la DIAN para realizar las pruebas de habilitación de facturación electrónica.
            El texto que copiaste desde el portal de la DIAN con nombre <i>IdentificadorPruebas</i>.
        </li>

        <li>
            <b>IdentificadorAplicaci\u00F3n [Texto]:</b>
            Identificador de la aplicación habilitado para la emisión de facturas electrónicas.
            El texto que copiaste desde el portal de la DIAN con nombre <i>IdentificadorAplicación</i>.
        </li>

        <li>
            <b>PinAplicaci\u00F3n [Texto]:</b>
            Pin elegido al habilitar la facturación electrónica en la DIAN.
            El texto que copiaste desde el portal de la DIAN con nombre <i>PinAplicación</i>.
        </li>

        <li>
            <b>ClaveT\u00E9cnicaAplicaci\u00F3n [Texto]:</b>
            Clave dada por la DIAN asociada a la aplicación.
            El texto que copiaste desde el portal de la DIAN con nombre <i>ClaveTécnicaAplicación</i>.
        </li>

        <li>
            <b>NombreContactoFacturaci\u00F3n [Texto]:</b>
            Nombre de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica.
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>Tel\u00E9fonoContactoFacturaci\u00F3n [Texto]:</b>
            Teléfono de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica.
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>EmailContactoFacturaci\u00F3n [Texto]:</b>
            Email de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica.
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>MostrarUnidad [Booleano]:</b>
            Ingresa <i>true</i> (sin comillas) si tu empresa vende productos con diferentes unidades de medida (par, unidad, etc) o
            si tu empresa no maneja diferentes unidades de medida, pero deseas que la unidad de medida <i>unidad</i> se muestre en la
            representación gráfica de la factura electrónica. Si no quieres que se muestre la unidad de medida ingresa <i>false</i>.
        </li>

    </ul>
    <img src="Imagenes/Habilitación Facturación Electrónica DIAN/AdiciónDatosEmpresa.png" />

    <p>Presiona <i>Ctrl + S</i> para guardar los cambios realizados.</p>

</body>

</html>